<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Message - Jayvee Hall of Mansion </title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<header>
<nav>
<ul>
<li><a href="home.html">HOME</a></li>
<li><a href="home.html#rooms">ROOM</a></li>
<li><a href="cart.html">CART</a></li>
<li><a href="message.html">MESSAGE</a></li>
<li><a href="notification.html">NOTIFICATION</a></li>
<li><a href="adminpanel.html">ADMIN</a></li>
</ul>
</nav>
<h2>Your Inbox</h2>
</header>
<main>
<div id="messagesList"></div>
<h3>Reply / Send Message</h3>
<form id="messageForm">
<input type="text" id="name" placeholder="Name" required><br>
<input type="email" id="email" placeholder="Email" required><br>
<input type="text" id="ref" placeholder="Reported Reference Number" required><br>
<textarea id="messageText" placeholder="Message"></textarea><br>
<button type="submit">Send</button>
</form>
</main>
<footer>
<p>Communicate with Jayvee Hall of Mansion staff for bookings and inquiries.</p>
</footer>
<script>
async function loadMessages(){
    const res = await fetch('api/getMessages.php');
    const messages = await res.json();
    const container = document.getElementById('messagesList');
    container.innerHTML = '';
    messages.forEach(msg=>{
        container.innerHTML += `<div class="message-item">
        <p>Date: ${msg.date}</p>
        <p>From: ${msg.from}</p>
        <p>Message: ${msg.message}</p>
        </div>`;
    });
}
loadMessages();

document.getElementById('messageForm').addEventListener('submit', async function(e){
    e.preventDefault();
    const payload = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        ref: document.getElementById('ref').value,
        message: document.getElementById('messageText').value
    };
    await fetch('api/sendMessage.php', {method:'POST', body: JSON.stringify(payload)});
    alert('Message sent!');
    loadMessages();
});
</script>
</body>
</html>
